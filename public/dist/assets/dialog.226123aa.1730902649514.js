var i=Object.defineProperty,t=(t,e,s)=>(((t,e,s)=>{e in t?i(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s})(t,"symbol"!=typeof e?e+"":e,s),s);import{q as e}from"./index.34872ab0.1730902649514.js";let s=[],n=null;const h={subject:[],closeLast(){const i=s.pop();return i?(i.close(),!0):(this.emit("refresh",s),!1)},closeAll(){let i=this.closeLast();for(;i;)i=this.closeLast();this.emit("refresh",s)},on(i,t){this.subject.push({event:i,callback:t})},off(i,t){if(i)for(let e=0;e<this.subject.length;e++)if(this.subject[e].event===i&&this.subject[e].callback===t){this.subject.splice(e,1);break}},emit(i,t){for(let e=0;e<this.subject.length;e++)this.subject[e].event===i&&this.subject[e].callback(t)}};let a=document.createElement("style");a.innerHTML="\n    .mtabUi-dialog{\n         opacity:0;\n         transform: scale(0.8) ;\n         animation: showDialog .3s forwards;\n    }\n    .window-mini{\n               margin-left:10px;\n               background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNzA2NjIwNDM5ODc0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjYyNDgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik01MTIgNTEybS00OTAuNjY2NjY3IDBhNDkwLjY2NjY2NyA0OTAuNjY2NjY3IDAgMSAwIDk4MS4zMzMzMzQgMCA0OTAuNjY2NjY3IDQ5MC42NjY2NjcgMCAxIDAtOTgxLjMzMzMzNCAwWiIgZmlsbD0iI0ZGQzEyRiIgcC1pZD0iNjI0OSI+PC9wYXRoPjwvc3ZnPg==);\n               background-size:100% 100%;\n               background-repeat:no-repeat;\n               background-position:center;\n               transition:all .3s;\n    }\n    .window-mini:hover{\n        background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNzA2NjIwNDQ2NzgzIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjY0MDQiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik01MTIgNTEybS00OTAuNjY2NjY3IDBhNDkwLjY2NjY2NyA0OTAuNjY2NjY3IDAgMSAwIDk4MS4zMzMzMzQgMCA0OTAuNjY2NjY3IDQ5MC42NjY2NjcgMCAxIDAtOTgxLjMzMzMzNCAwWiIgZmlsbD0iI0ZGQzEyRiIgcC1pZD0iNjQwNSI+PC9wYXRoPjxwYXRoIGQ9Ik0yNTcuMjggNDY5LjMzMzMzM2g1MTJhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDEgMSAwIDg1LjMzMzMzNGgtNTEyYTQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEgMC04NS4zMzMzMzR6IiBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9Ii43IiBwLWlkPSI2NDA2Ij48L3BhdGg+PC9zdmc+);\n    }\n    .window-close{\n               margin-left:10px;\n               background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNzA2NjIwNDcxMzQzIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9Ijg1ODUiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik01MTIgMTAyNEE1MTIgNTEyIDAgMSAwIDUxMiAwYTUxMiA1MTIgMCAwIDAgMCAxMDI0eiIgZmlsbD0iI0ZGNUY1NyIgcC1pZD0iODU4NiI+PC9wYXRoPjwvc3ZnPg==);\n               background-size:100% 100%;\n               background-repeat:no-repeat;\n               background-position:center;\n               transition:all .3s;\n    }\n    .window-close:hover{\n        background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNzA2NjIwNDc0MDUwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9Ijg3NDEiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik01MTIgNTEybS00OTAuNjY2NjY3IDBhNDkwLjY2NjY2NyA0OTAuNjY2NjY3IDAgMSAwIDk4MS4zMzMzMzQgMCA0OTAuNjY2NjY3IDQ5MC42NjY2NjcgMCAxIDAtOTgxLjMzMzMzNCAwWiIgZmlsbD0iI0ZGNjE1NyIgcC1pZD0iODc0MiI+PC9wYXRoPjxwYXRoIGQ9Ik03MjQuNDggMzAwLjhhNDIuNjY2NjY3IDQyLjY2NjY2NyAwIDAgMSAwIDYwLjMzMDY2N0w1NzMuNjEwNjY3IDUxMiA3MjQuNDggNjYyLjg2OTMzM2E0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMSAxLTYwLjMzMDY2NyA2MC4zMzA2NjdMNTEzLjI4IDU3Mi4yNDUzMzMgMzYyLjQ5NiA3MjMuMmE0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMSAxLTYwLjQxNi02MC4zMzA2NjdsMTUwLjg2OTMzMy0xNTAuOTU0NjY2TDMwMi4wOCAzNjEuMTMwNjY3YTQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEgNjAuNDE2LTYwLjMzMDY2N2wxNTAuNzg0IDE1MC43ODQgMTUwLjg2OTMzMy0xNTAuNzg0YTQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEgNjAuMzMwNjY3IDB6IiBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9Ii43IiBwLWlkPSI4NzQzIj48L3BhdGg+PC9zdmc+);\n    }\n    .window-full{\n               margin-left:10px;\n               background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNzA2NjIwNDU0ODYzIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9Ijc0MTIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik01MTIgNTEybS00OTAuNjY2NjY3IDBhNDkwLjY2NjY2NyA0OTAuNjY2NjY3IDAgMSAwIDk4MS4zMzMzMzQgMCA0OTAuNjY2NjY3IDQ5MC42NjY2NjcgMCAxIDAtOTgxLjMzMzMzNCAwWiIgZmlsbD0iIzJBQ0I0MiIgcC1pZD0iNzQxMyI+PC9wYXRoPjwvc3ZnPg==);\n               background-size:100% 100%;\n               background-repeat:no-repeat;  \n               background-position:center; \n               transform:rotate(90deg);\n               transition:all .3s;\n    }\n    .window-full:hover{\n        background-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNzA2NjIwNDU4NTIxIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9Ijc1NjgiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxwYXRoIGQ9Ik01MTIgNTEybS00OTAuNjY2NjY3IDBhNDkwLjY2NjY2NyA0OTAuNjY2NjY3IDAgMSAwIDk4MS4zMzMzMzQgMCA0OTAuNjY2NjY3IDQ5MC42NjY2NjcgMCAxIDAtOTgxLjMzMzMzNCAwWiIgZmlsbD0iIzJBQ0I0MiIgcC1pZD0iNzU2OSI+PC9wYXRoPjxwYXRoIGQ9Ik03NjggMzc2LjY2MTMzM1Y3MjUuMzMzMzMzYTQyLjY2NjY2NyA0Mi42NjY2NjcgMCAwIDEtNDIuNjY2NjY3IDQyLjY2NjY2N0gzNzYuNjYxMzMzTDc2OCAzNzYuNTc2ek02NDcuMzM4NjY3IDI1NkwyNTYgNjQ3LjMzODY2NyAyNTYgMjk4LjY2NjY2N2E0Mi42NjY2NjcgNDIuNjY2NjY3IDAgMCAxIDQyLjY2NjY2Ny00Mi42NjY2NjdoMzQ4Ljc1NzMzM3oiIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iLjciIHAtaWQ9Ijc1NzAiPjwvcGF0aD48L3N2Zz4=);\n    }\n    @keyframes showDialog{\n      0%{\n        opacity:0;\n        transform: scale(0.8) translateY(60px);\n      }\n      100%{\n        opacity:1;\n        transform:scale(1) translateY(0px);\n      }\n    }\n",document.head.append(a);class o{constructor(i={}){t(this,"dialogHandle",null),t(this,"frameHandle",null),t(this,"iframeHandle",null),t(this,"zIndex",5e3),t(this,"width",850),t(this,"height",650),t(this,"left",-1),t(this,"top",-1),t(this,"url",""),t(this,"isMove",!1),t(this,"isFull",!1),t(this,"isMinimize",!1),t(this,"minWindow",!1),t(this,"maxWindow",!1),t(this,"minimization",null),t(this,"maximize",null),t(this,"title",""),t(this,"headerHeight",35),t(this,"footerHeight",80),t(this,"minWidth",320),t(this,"minHeight",450),t(this,"borderRadius","10px"),t(this,"immersion",!1),t(this,"controllerSize","17px"),t(this,"controllerColor","#ffffff"),t(this,"resize",!0),t(this,"movePoint",{x:0,y:0,layerX:0,layerY:0}),t(this,"lastSize",{left:0,top:0,width:0,height:0}),t(this,"origin",{}),t(this,"uid",""),t(this,"ico",""),t(this,"lastClickTime",""),t(this,"tmpTime",!1),t(this,"custom",{}),t(this,"uuid",(()=>"xxxxxxxx-xxx-xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){const t=16*Math.random()|0;return("x"===i?t:3&t|8).toString(16)})))),t(this,"windowMove",(i=>{if(this.isMove){const{x:t,y:e}=i;this.isFull||this.setPosition(t-this.movePoint.layerX,e-this.movePoint.layerY)}})),t(this,"windowMouseUp",(()=>{this.isMove=!1,this.iframeHandle.style.pointerEvents="",this.frameHandle.style.cursor=""})),this.lastClickTime=(new Date).getTime(),this.uid=this.uuid();let{url:n=!1,ico:h=!1,width:a=!1,height:o=!1,title:M="",origin:l={},minHeight:d=0,minWidth:N=0,minWindow:g=300,maxWindow:I="",custom:j={}}=i;n&&(this.url=n),j||(j={});const{immersion:c=!1,controllerColor:r="#ffffff",minimization:m=1,maximize:z=1,resize:u=1}=j;this.resize=u,(c||/^\//.test(this.url))&&(this.immersion=!0),this.url=e(this.url),r&&(this.controllerColor=r),this.minimization=m,this.maximize=z,this.ico=e(h),a&&(this.width=a),j&&(this.custom=j),document.querySelector(".footer-component")||(this.footerHeight=0,this.minimization=!1),o&&(this.height=o,this.height>window.innerHeight&&(this.height=window.innerHeight)),this.minWindow=g,this.maxWindow=I,N&&(this.minWidth=N),d&&(this.minHeight=d,this.minHeight>window.innerHeight&&(this.minHeight=window.innerHeight)),window.innerWidth<500&&(this.width=window.innerWidth,this.height=window.innerHeight,this.minimization=!1,this.maximize=!1,this.borderRadius="0px"),this.origin=l,this.title=M,s.push(this)}setTitle(i=""){this.immersion||(this.title=i.length>0?i:this.title,this.titleHandle=document.createElement("div"),this.titleHandle.innerHTML=`${/^txt:/.test(this.ico)?"":`<img class="mtabUI-ico" src="${this.ico}" alt="ico"/>`}<span>${this.title}</span>`,Object.assign(this.titleHandle.style,{marginLeft:"5px",display:"flex",fontSize:"15px",pointerEvents:"none",alignItems:"center",height:this.px(this.headerHeight)}),this.frameHandle.appendChild(this.titleHandle))}getTextColor(i){return.299*parseInt(i.substring(1,3),16)+.587*parseInt(i.substring(3,5),16)+.114*parseInt(i.substring(5,7),16)>186?"#000000":"#ffffff"}Frame(){this.frameHandle=document.createElement("div"),this.frameHandle.dataset.drag="move",Object.assign(this.frameHandle.style,{position:"absolute",background:this.immersion?"transparent":this.controllerColor,color:this.getTextColor(this.controllerColor||"#ffffff"),top:"0px",left:"0px",borderRadius:"8px 8px 0px 0px",width:"100%",display:"flex",height:this.immersion?"15px":this.px(this.headerHeight),userSelect:"none"}),this.frameHandle.onmousedown=i=>{const{drag:t=""}=i.target.dataset;if("move"===t){if(this.lastClickTime>(new Date).getTime()-500)return void(this.maximize&&this.setFull());this.lastClickTime=(new Date).getTime();const{x:t,y:e,layerX:s,layerY:n}=i;this.movePoint.x=t,this.movePoint.y=e,this.movePoint.layerX=s,this.movePoint.layerY=n,this.iframeHandle.style.pointerEvents="none",this.isMove=!0}this.resetIndex()},this.setTitle(this.title);const i=document.createElement("div");return Object.assign(i.style,{marginLeft:"auto",width:"max-content",height:"100%",display:"flex"}),1===parseInt(this.minimization)&&this.miniFrame(i),1===parseInt(this.maximize)&&this.fullFrame(i),this.closeFrame(i),this.frameHandle.appendChild(i),this.frameHandle}closeFrame(i){let t=document.createElement("div");t.className="window-close",t.title="关闭窗口",Object.assign(t.style,{marginTop:this.immersion?"10px":"8px",width:this.controllerSize,height:this.controllerSize,marginRight:"10px"}),t.onclick=i=>{this.close(),i.stopPropagation()},i.appendChild(t)}fullFrame(i){let t=document.createElement("div");t.className="window-full",t.title="最大化窗口",Object.assign(t.style,{marginTop:this.immersion?"10px":"8px",width:this.controllerSize,height:this.controllerSize,display:"flex",userSelect:"none"}),t.onclick=()=>{this.setFull()},i.appendChild(t)}miniFrame(i){let t=document.createElement("div");t.className="window-mini",t.title="最小化",t.onclick=()=>{this.setMineSize()},Object.assign(t.style,{marginTop:this.immersion?"10px":"8px",width:this.controllerSize,height:this.controllerSize,display:"flex",userSelect:"none"}),i.appendChild(t)}refreshFrame(i){if(/^http/.test(this.url))return!1;let t=document.createElement("div");t.className="window-refresh",t.innerHTML='<img src="data:image/svg+xml;base64,PHN2ZyB0PSIxNzA0NjI3ODc5MjM5IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjE2NzYiIHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4Ij48cGF0aCBkPSJNMzc5LjM5MiA4NzAuNGMtOTIuNjcyLTQ0LjgyOC0xNzEuOTE4LTE0My4xOS0xOTguMDMtMjQ1Ljc2LTI0LjU3Ni05Ni40ODQtNi4yNTgtMjAwLjkzMiA1MC41MTctMjg4LjU0IDQ4LjgxLTc1LjIwOCAxMTcuMTkxLTEyNS44OTYgMjE3LjMxNi0xNjEuMTEgMjQuNjktOC43MDQgNDQuOTQyLTE4LjM3NSA0NC45NDItMjEuNTYgMC0zLjEzLTEwLjkyMy0xNi42MTItMjQuMjkyLTI5LjkyNC0yNy4zMDYtMjcuMTkzLTI5LjU4Mi0zNi45MjEtMTIuNDAxLTU0LjI3MiAxOS45MS0yMC4xMzkgMzYuNTgtMTYuMzI3IDcxLjY4IDE2LjMyNyAxNi44MzkgMTUuNjQ0IDQ2LjU5MiA0MS4zMDEgNjYuMTA0IDU3LjAwMyAzOC4yMyAzMC43MiA0Ny42MTYgNDQuNiA0Mi44OTUgNjMuNjAxLTIuNjc0IDEwLjQ2OC01Ny44NTYgODIuNzc0LTk4LjgxNiAxMjkuNDgtMTkuMjI5IDIxLjkwMi0zMi4wODYgMjcuNTktNDYuODIgMjAuODJhNDQuMzczIDQ0LjM3MyAwIDAgMS0xNy43NS0xNi40OTdjLTcuMTEtMTMuNTQtMC42ODItMjcuNzYyIDI4Ljc4Ny02My4zNzQgMTAuODA4LTEzLjA4NSAxOS43NC0yNS42IDE5Ljc0LTI3LjcwNSAwLTcuNzk0LTI1LjY1Ny0xMC4wMTMtNTQuOTU1LTQuNzIyLTUxLjI1NyA5LjIxNi05Ni44MjUgMzQuOTg3LTE0MS45OTQgODAuMjEzLTIyLjUyOCAyMi41ODUtNDUuMjI3IDUwLjc0NS01Mi4xNjcgNjQuNjgzLTQ4LjkyNSA5OC4zNjEtNDYuNTM2IDIxMS43OTcgNi4zNzEgMzAyLjc2MyAyNC40NjIgNDEuOTI3IDgxLjIzNyA5NS44NTggMTIyLjkzNyAxMTYuNjIyIDk2LjgyNSA0OC4yNDIgMjA0LjM0NSA0NS4zOTcgMjk0LjY4NC03LjczN0M4MDYuNCA3MzcuMTY2IDg2Ny41NTYgNjAxLjI2IDg0Mi4xODMgNDgwLjgyNWMtOC43MDQtNDEuNTI5LTM0LjM2LTk4LjI0Ny01OS4yNzgtMTMxLjMtMjIuNjk5LTMwLjAzNy0yOC4yNzQtNDMuMjM1LTI0LjYzMy01OC4wMjYgMy45MjUtMTUuNzU5IDI2LjM0LTI0LjQwNiA0Mi4zODItMTYuMjcgMjguNDQ1IDE0LjI3OSA4Mi4zNzUgOTkuNjY5IDk5Ljg0IDE1Ny45OCAxMy45MzggNDYuMzY0IDEyLjY4NiAxNTUuMDc5LTIuMjc1IDIwMy45NDctMTMuMDg1IDQyLjY2Ni00Ni4yNTEgMTA4LjM3My02OS42MzIgMTM4LjA2OS0yNC4xNzggMzAuNzItNzguNTA3IDc1LjIwNy0xMTYuMDU0IDk1LjIzMi01OS4xNjQgMzEuNDAzLTE0My40MTcgNDYuMDgtMjEzLjU2IDM3LjIwNS00Ni4zMDgtNS44Ni03MC4xNDUtMTMuMzEyLTExOS41ODEtMzcuMjYyeiIgcC1pZD0iMTY3NyI+PC9wYXRoPjwvc3ZnPg==" style="width: 20px;height: 20px;margin: auto;cursor: pointer;"  alt="refresh"/>',t.title="刷新",Object.assign(t.style,{width:"40px",height:this.px(this.headerHeight),display:"flex",userSelect:"none"}),t.onclick=()=>{this.iframeHandle.contentWindow.location.reload()},i.appendChild(t)}setFull(){this.tmpTime&&this.tmpTime>(new Date).getTime()-500||(this.tmpTime=(new Date).getTime(),this.isFull?(Object.assign(this.dialogHandle.style,{width:this.px(this.lastSize.width),height:this.px(this.lastSize.height),left:this.px(this.lastSize.left),top:this.px(this.lastSize.top)}),setTimeout((()=>{Object.assign(this.dialogHandle.style,{transition:"none"})}),300),this.isFull=!1):(Object.assign(this.dialogHandle.style,{transition:"all .3s"}),Object.assign(this.dialogHandle.style,{width:"100%",height:`calc(100% - ${this.footerHeight}px)`,left:"0px",top:"0px"}),this.lastSize={left:this.left,top:this.top,width:this.width,height:this.height},this.isFull=!0))}resetIndex(){let i=0,t=null;s.forEach((e=>{e.zIndex>i&&(i=e.zIndex,t=e)})),t.uid!==this.uid&&(n=this.uid,i+=1),this.setZIndex(i)}Iframe(){return this.iframeHandle=document.createElement("iframe"),this.iframeHandle.src=this.url,this.iframeHandle.dataset.uid=this.uid,this.iframeHandle.className="WebAppEngine",Object.assign(this.iframeHandle.style,{position:"absolute",top:this.immersion?0:this.px(this.headerHeight),border:"none",outline:"none",transform:"scale(1)",width:"100%",height:this.immersion?"100%":`calc(100% - ${this.px(this.headerHeight)})`}),this.iframeHandle.onload=()=>{setTimeout((()=>{this.immersion&&(this.dialogHandle.style.background="transparent")}),500)},this.iframeHandle}px(i){return i+"px"}getElementCenterPosition(i,t){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=Math.floor((e-i)/2);let h=Math.floor((s-(document.querySelector(".footer-component")?77:0)-t)/2);return this.height>=window.innerHeight-77&&(h=0),{x:n,y:h}}setPosition(i=0,t=0){i<0&&(i=0),i>window.innerWidth-this.width&&(i=window.innerWidth-this.width),t<0&&(t=0),t>window.innerHeight-this.height&&(t=window.innerHeight-this.height),this.left=i,this.top=t,Object.assign(this.dialogHandle.style,{left:this.px(i),top:this.px(t)})}setZIndex(i=1e3){this.zIndex=i,this.dialogHandle.style.zIndex=this.zIndex}append(){document.body.appendChild(this.dialogHandle),h.emit("refresh",s)}setMineSize(){!0===this.isMinimize?(this.dialogHandle.style.display="block",this.isMinimize=!1):(this.dialogHandle.style.display="none",this.isMinimize=!0)}open(){this.dialogHandle=document.createElement("div");const{x:i,y:t}=this.getElementCenterPosition(this.width,this.height);this.left=i,this.top=t,this.dialogHandle.className="mtabUi-dialog",Object.assign(this.dialogHandle.style,{position:"fixed",background:this.controllerColor,width:this.px(this.width),height:this.px(this.height),left:this.px(i),top:this.px(t),minWidth:this.px(this.minWidth),minHeight:this.px(this.minHeight),resize:this.resize>0?"auto":"none",borderRadius:this.borderRadius}),this.dialogHandle.appendChild(this.Iframe()),this.dialogHandle.appendChild(this.Frame()),this.append(),this.bindEvent(),this.resetIndex()}bindEvent(){window.addEventListener("mousemove",this.windowMove),window.addEventListener("mouseup",this.windowMouseUp);new MutationObserver((i=>{i.forEach((i=>{this.width=this.dialogHandle.clientWidth,this.height=this.dialogHandle.clientHeight}))})).observe(this.dialogHandle,{attributes:!0,childList:!1,subtree:!1})}close(){window.removeEventListener("mousemove",this.windowMove),window.removeEventListener("mouseup",this.windowMouseUp),s.forEach(((i,t)=>{i.uid===this.uid&&s.splice(t,1)})),document.body.removeChild(this.dialogHandle),h.emit("refresh",s)}}window.MtabManager=h,window.WebAppEngineTime&&clearInterval(window.WebAppEngineTime),window.WebAppEngineTime=setInterval((()=>{if(s.length>0){const i=function(){const i=document.activeElement;return i&&"WebAppEngine"===i.className?i:null}();if(i){let t=i.dataset.uid;if(t!==n){const i=s.find((i=>i.uid===t));i&&(n=t,i.resetIndex())}}}}),200),window.MtabUi=o;export{o as M,s as d};

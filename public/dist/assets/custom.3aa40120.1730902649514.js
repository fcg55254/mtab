import{r as e,at as l,u as a,e as t,C as s,a as u,b as o,c as i,d as r,k as d,h as n,I as c,j as v,W as p,i as m,aY as b,v as g,m as f,q as h,p as x,F as _,f as k,g as w,x as y,V,J as C}from"./index.34872ab0.1730902649514.js";import{u as j}from"./index.e2fe5762.1730902649514.js";import{T as U}from"./textIcon.3c9e3b5d.1730902649514.js";import"./wapp.bd2b2f5f.1730902649514.js";import"./sortable.esm.c2baa127.1730902649514.js";import"./dialog.226123aa.1730902649514.js";import"./app.7e4ab096.1730902649514.js";import"./index.ba2374e6.1730902649514.js";import"./wangEditor.c4e29644.1730902649514.js";import"./defavatar.fe9b13f3.1730902649514.js";import"./noLogo.563a3881.1730902649514.js";/* empty css                                                                 */const I={class:"customBox relative pb-6 overflow-y-scroll"},z={class:"flex gap-4 w-full"},L={class:"flex gap-4 w-full"},E={class:"col-span-2 h-16 flex"},G={class:"iconsel absolute z-20"},O={class:"iconsel absolute z-10"},R=["src"],B={class:"iconsel absolute z-10"},P=["src"],S={class:"bgColorPicker"},T=["onClick"],W={key:0,class:"touming"},q={key:0,style:{"font-size":"20px",color:"#ff0000",inset:"-5px 3px",position:"relative"}},F={key:0,style:{"font-size":"20px",color:"#d9d9d9",inset:"-5px 3px",position:"relative"}},J={class:"whitespace-break-spaces",style:{"line-height":"16px"}},Y={class:"w-full xs:pl-20 mt-6 flex"},A={__name:"custom",props:{data:{type:Object,default:()=>{}}},setup(A){var D;const H=e(""),K=e(!1),M={userid:l("user_id"),token:l("token"),"Up-Type":"icon"},N=window.innerWidth,Q=["rgba(0,0,0,0)","#fff","rgb(22, 129, 255)","rgb(251, 190, 35)","rgb(252, 69, 72)","rgb(75, 60, 54)","rgb(125, 172, 104)","rgb(2, 51, 115)","rgb(200, 172, 112)","rgb(55, 33, 40)","rgb(5, 64, 146)"],X=e(!1),Z=e(2),$=e=>{Z.value=e},ee=A,le=e(!1),ae=a(),te={id:"",name:"",src:"",url:"",size:"1x1",type:"icon",sort:99999,app:0,tips:"",bgColor:null,pageGroup:""},se=e(Object.assign({},te));(null==(D=ee.data)?void 0:D.id)&&(se.value=Object.assign(se.value,ee.data)),/^txt:/.test(se.value.src)?(H.value=se.value.src.replace(/txt:/,""),se.value.src="",Z.value=3):se.value.src&&(Z.value=1);const ue=async()=>{var e;le.value=!0;try{const e=await V({url:"/LinkStore/getIcon",method:"post",data:{url:se.value.url}});if(1===e.code)return se.value.src=e.data.src,se.value.name=e.data.name,le.value=!1,void(Z.value=1)}catch(l){}try{const l=await V({url:"/api/getIcon",method:"post",data:{url:se.value.url}});1===l.code?(se.value.src=l.data.src,l.data.name&&(se.value.name=null==(e=l.data)?void 0:e.name.substring(0,20)),Z.value=1):C.error(l.msg)}catch(l){console.error("Error fetching data:",l),C.error("获取网站数据失败,请手动设置")}le.value=!1},oe=e=>{1===e.code?(se.value.src=e.data.url,Z.value=1):C.warning(e.msg)},ie=async()=>{if(""===se.value.name||""===se.value.url)return C.warning("请设置标签信息");if(le.value=!0,"tab"===se.value.url.slice(0,3)||1===se.value.app||"http"!==se.value.url.slice(0,4)&&(se.value.url="http://"+se.value.url),3===Z.value&&(se.value.src="txt:"+H.value),2===Z.value)try{const e=await V({url:"/api/getIcon",method:"post",data:{avatar:se.value.url}});1===e.code&&(se.value.src=e.data.src)}catch(e){}""===se.value.id?(K.value&&V({url:"/LinkStore/push",method:"post",data:se.value}).finally((e=>{})),se.value.id=j(),se.value.pageGroup=ae.state.pageGroup,ae.state.link.push(se.value),ae.commit("updateLink")):(ae.commit("setLink",se.value),t.emit("refreshGroup")),le.value=!1,t.emit("closePlugin"),X.value=!1};return t.on("linkEdit",((e={})=>{e&&(se.value=Object.assign({},te)),X.value=!0})),s((()=>{t.off("linkEdit".open)})),(e,l)=>{const a=u("el-input"),t=u("el-button"),s=u("el-form-item"),V=u("el-upload"),C=u("el-icon"),j=u("el-color-picker"),A=u("el-switch"),D=u("el-checkbox"),X=u("el-form");return o(),i("div",I,[r("div",null,[d(X,{"label-position":v(N)<500?"top":"right","label-width":"80px",class:"w-full mt-4"},{default:n((()=>[d(s,{label:"标签网址"},{default:n((()=>[r("div",z,[d(a,{class:"input_div w-full",modelValue:se.value.url,"onUpdate:modelValue":l[0]||(l[0]=e=>se.value.url=e),"show-word-limit":"",maxlength:"1000",placeholder:"请输入带http开头的网址"},null,8,["modelValue"]),d(t,{type:"primary",onClick:ue,loading:le.value},{default:n((()=>l[11]||(l[11]=[c("获取图标")]))),_:1},8,["loading"])])])),_:1}),d(s,{label:"标签名称"},{default:n((()=>[d(a,{maxlength:"100",class:"input_div","show-word-limit":"",modelValue:se.value.name,"onUpdate:modelValue":l[1]||(l[1]=e=>se.value.name=e),placeholder:"标签名称"},null,8,["modelValue"])])),_:1}),d(s,{label:"标签简介"},{default:n((()=>[d(a,{class:"input_div",maxlength:"200","show-word-limit":"",rows:"1",modelValue:se.value.tips,"onUpdate:modelValue":l[2]||(l[2]=e=>se.value.tips=e),placeholder:"简单介绍标签（非必填）"},null,8,["modelValue"])])),_:1}),d(s,{label:"文字图标"},{default:n((()=>[d(a,{class:"input_div",maxlength:"200","show-word-limit":"",rows:"1",modelValue:H.value,"onUpdate:modelValue":l[3]||(l[3]=e=>H.value=e),placeholder:"请输入1-5个字符的图标内容（可选项，当标签图标获取不到可使用文字图标代替）"},null,8,["modelValue"])])),_:1}),d(s,{label:"标签图标"},{default:n((()=>[r("div",L,[d(a,{class:"input_div",modelValue:se.value.src,"onUpdate:modelValue":l[4]||(l[4]=e=>se.value.src=e),placeholder:"请上传或粘贴标签图标地址,支持png,jpg,ico,svg,webp格式"},null,8,["modelValue"]),d(V,{class:"upload-demo","show-file-list":!1,"on-success":oe,headers:M,action:v(p)+v(ae).state.site.upload},{default:n((()=>[d(t,{type:"danger"},{default:n((()=>l[12]||(l[12]=[c("手动上传")]))),_:1})])),_:1},8,["action"])])])),_:1}),d(s,{label:"选择图标"},{default:n((()=>[r("div",E,[H.value?(o(),i("div",{key:0,class:"relative mr-3",onClick:l[5]||(l[5]=e=>$(3))},[m(r("div",G,[d(C,null,{default:n((()=>[d(v(b))])),_:1})],512),[[g,3===Z.value]]),d(U,{style:{width:"60px",height:"60px",border:"2px solid #d9d9d9"},text:"txt:"+H.value,bgColor:se.value.bgColor},null,8,["text","bgColor"])])):f("",!0),se.value.src?(o(),i("div",{key:1,class:"relative",onClick:l[6]||(l[6]=e=>$(1))},[m(r("div",O,[d(C,null,{default:n((()=>[d(v(b))])),_:1})],512),[[g,1===Z.value]]),r("img",{src:v(h)(se.value.src),class:"mr-3",style:x({width:"60px",height:"60px",backgroundColor:se.value.bgColor,borderRadius:"var(--iconRadius)"})},null,12,R)])):f("",!0),r("div",{class:"relative",onClick:l[7]||(l[7]=e=>$(2))},[m(r("div",B,[d(C,null,{default:n((()=>[d(v(b))])),_:1})],512),[[g,2===Z.value]]),r("img",{src:v(p)+"/api/renderIco?seed="+encodeURI(se.value.url),class:"mr-3 bg-slate-100",style:{width:"60px",height:"60px","border-radius":"var(--iconRadius)"}},null,8,P)])])])),_:1}),d(s,{label:"背景颜色"},{default:n((()=>[r("ul",S,[(o(),i(_,null,k(Q,(e=>r("li",{onClick:l=>{return a=e,void(se.value.bgColor=a);var a}},["rgba(0,0,0,0)"===e?(o(),i("div",W,[e===se.value.bgColor?(o(),i("b",q,"√")):f("",!0)])):(o(),i("div",{key:1,style:x({backgroundColor:e})},[e===se.value.bgColor?(o(),i("b",F,"√")):f("",!0)],4))],8,T))),64)),d(j,{"show-alpha":"",modelValue:se.value.bgColor,"onUpdate:modelValue":l[8]||(l[8]=e=>se.value.bgColor=e)},null,8,["modelValue"])])])),_:1}),d(s,{label:"内嵌窗口"},{default:n((()=>[d(A,{"active-value":1,"inactive-value":0,modelValue:se.value.app,"onUpdate:modelValue":l[9]||(l[9]=e=>se.value.app=e)},null,8,["modelValue"]),l[13]||(l[13]=r("span",{class:"ml-6 text-xs text-red-500"},"内嵌窗口形式打开，第三方可能不兼容",-1))])),_:1}),"1"===v(ae).state.site.is_push_link_store&&""===se.value.id?(o(),w(s,{key:0,label:"推送标签"},{default:n((()=>[d(D,{checked:Boolean(parseInt(v(ae).state.site.is_push_link_status)),modelValue:K.value,"onUpdate:modelValue":l[10]||(l[10]=e=>K.value=e)},{default:n((()=>[r("div",J,y(v(ae).state.site.is_push_link_store_tips),1)])),_:1},8,["checked","modelValue"])])),_:1})):f("",!0)])),_:1},8,["label-position"]),r("div",Y,[d(t,{type:"primary",size:"default",class:"w-full",onClick:ie},{default:n((()=>l[14]||(l[14]=[c("保存")]))),_:1})])])])}}};export{A as default};
